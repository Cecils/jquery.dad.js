!function(r){"use strict";var o="ontouchstart"in window||navigator.msMaxTouchPoints;function i(){this.positionX=0,this.positionY=0,this.offsetX=0,this.offsetY=0}i.prototype.update=function(t){var e,i;o&&"touchmove"==t.type?(e=t.originalEvent.touches[0],i=document.elementFromPoint(e.clientX,e.clientY),r(i).trigger("touchenter"),this.positionX=e.pageX,this.positionY=e.pageY):(this.positionX=t.pageX,this.positionY=t.pageY)};new i;function e(t,e){this.options=e,this.$container=r(t),this.$children=this.$container.children(),this.$target=null,this.$clone=null,this.mouse=new i,this.active=!0,this.holding=!1,this.dragging=!1,this.setup()}e.prototype.setup=function(){var e=this;this.$container.css({position:"relative","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"}),this.$container.find("img").attr("ondragstart","return false"),this.$children.each(function(t){r(this).data("dad-id",t)}),this.$children.on("mousedown touchstart",function(t){e.dragging||e.prepare(t,this)}),this.$children.on("mouseenter touchenter",function(t){e.dragging&&e.updatePlaceholderPosition(t,this)}),r("body").on("mousemove touchmove",this.update.bind(this)),r("body").on("mouseup touchend",this.end.bind(this)),r("body").on("mouseleave",this.end.bind(this))},e.prototype.prepare=function(t,e){this.holding=!0,this.$target=r(e)},e.prototype.start=function(t){var e=this.$target,i=e.offset().top-this.$container.offset().top,o=e.offset().left-this.$container.offset().left,s=e.outerHeight(),n=e.outerWidth(),h=e.clone().css({position:"absolute",pointerEvents:"none",height:s,width:n}),a=r(this.options.placeholder).css({position:"absolute",top:i,left:o,width:n,height:s});this.mouse.offsetX=this.mouse.positionX-e.offset().left,this.mouse.offsetY=this.mouse.positionY-e.offset().top,e.data("dad-active",!0),e.css("visibility","hidden"),this.dragging=!0,this.$target=e,this.$clone=h,this.$placeholder=a,this.$container.append(a).append(h),this.updateClonePosition()},e.prototype.update=function(t){this.holding&&!this.dragging&&this.start(t),this.dragging&&(this.mouse.update(t),this.updateClonePosition())},e.prototype.end=function(){var t,e,i,o,s,n;this.holding=!1,this.dragging&&(t=this.$container,e=this.$target,i=this.$clone,o=this.$placeholder,s=e.offset().left-t.offset().left,n=e.offset().top-t.offset().top,i.animate({top:n,left:s},this.options.transition,function(){i.remove(),o.remove(),e.removeData("dad-active"),e.css("visibility","visible")}),this.dragging=!1,this.$target=null,this.$clone=null,this.$placeholder=null)},e.prototype.updateClonePosition=function(){var t=this.$container.offset().top,e=this.$container.offset().left,i=this.mouse.positionY-t-this.mouse.offsetY,o=this.mouse.positionX-e-this.mouse.offsetX;this.$clone.css({top:i,left:o})},e.prototype.updatePlaceholderPosition=function(t,e){var i=r(e);i.index()>this.$target.index()?i.after(this.$target):i.before(this.$target);var o=this.$target,s=o.offset().top-this.$container.offset().top,n=o.offset().left-this.$container.offset().left,h=o.outerHeight(),a=o.outerWidth();this.$placeholder.css({top:s,left:n,width:a,height:h})},e.prototype.activate=function(){this.active=!1},e.prototype.deactivate=function(){this.active=!1},r.fn.dad=function(t){t=r.extend({placeholder:"<div style='border: 1px dashed white'></div>",transition:200,active:!0},t);return r(this).each(function(){this.dad=new e(this,t)}),{addDropzone:function(){}}}}(jQuery);